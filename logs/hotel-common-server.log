(node:45852) [MODULE_TYPELESS_PACKAGE_JSON] Warning: Module type of file:///Users/kaneko/hotel-common/dist/server/minimal-server.js is not specified and it doesn't parse as CommonJS.
Reparsing as ES module because module syntax was detected. This incurs a performance overhead.
To eliminate this warning, add "type": "module" to /Users/kaneko/hotel-common/package.json.
(Use `node --trace-warnings ...` to show where the warning was created)
node:events:502
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3400
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at file:///Users/kaneko/hotel-common/dist/server/minimal-server.js:318:8
    at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1944:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3400
}

Node.js v20.19.2

ğŸš¨ ç·Šæ€¥å¯¾å¿œï¼šhotel-commonæœ€å°ç‰ˆã‚µãƒ¼ãƒãƒ¼èµ·å‹•æˆåŠŸï¼

ğŸ“Š ã‚µãƒ¼ãƒãƒ¼æƒ…å ±:
- ãƒãƒ¼ãƒˆ: 3400
- ãƒ¢ãƒ¼ãƒ‰: ç·Šæ€¥ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- å¯¾è±¡: Sunoéšå±¤æ¨©é™çµ±åˆæ”¯æ´
- çŠ¶æ…‹: âœ… æ­£å¸¸å‹•ä½œä¸­

âœ… åˆ©ç”¨å¯èƒ½APIï¼ˆå…¨ã¦ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè£…ï¼‰:
- GET  /health                                              â†’ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/campaigns/active                               â†’ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å–å¾—
- POST /api/hotel-member/hierarchy/auth/verify             â†’ JWTæ¤œè¨¼ï¼ˆè¨±å¯ï¼‰
- POST /api/hotel-member/hierarchy/permissions/check-customer-access â†’ é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆè¨±å¯ï¼‰
- POST /api/hotel-member/hierarchy/tenants/accessible      â†’ ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§
- POST /api/hotel-member/hierarchy/permissions/check-membership-restrictions â†’ ä¼šå“¡åˆ¶é™ï¼ˆãªã—ï¼‰
- POST /api/hotel-member/hierarchy/permissions/check-analytics-access â†’ åˆ†ææ¨©é™ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
- POST /api/hotel-member/hierarchy/user/permissions-detail â†’ æ¨©é™è©³ç´°
- POST /api/hotel-member/hierarchy/permissions/batch-check â†’ ãƒãƒƒãƒæ¨©é™ãƒã‚§ãƒƒã‚¯
- GET  /api/hotel-member/hierarchy/health                  â†’ éšå±¤ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

ğŸ¯ ç›®çš„: Sunoã®éšå±¤æ¨©é™çµ±åˆå®Ÿè£…ã‚’ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤
âš ï¸  æ³¨æ„: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºç”¨ãƒ»åŸºæœ¬çš„ã«å…¨ã¦è¨±å¯ï¼‰
ğŸ”„ å¾Œã§å®Œå…¨ç‰ˆã«ç½®ãæ›ãˆäºˆå®š
  

ğŸš¨ ç·Šæ€¥å¯¾å¿œï¼šhotel-commonæœ€å°ç‰ˆã‚µãƒ¼ãƒãƒ¼èµ·å‹•æˆåŠŸï¼

ğŸ“Š ã‚µãƒ¼ãƒãƒ¼æƒ…å ±:
- ãƒãƒ¼ãƒˆ: 3400
- ãƒ¢ãƒ¼ãƒ‰: ç·Šæ€¥ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- å¯¾è±¡: Sunoéšå±¤æ¨©é™çµ±åˆæ”¯æ´
- çŠ¶æ…‹: âœ… æ­£å¸¸å‹•ä½œä¸­

âœ… åˆ©ç”¨å¯èƒ½APIï¼ˆå…¨ã¦ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè£…ï¼‰:
- GET  /health                                              â†’ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/campaigns/active                               â†’ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å–å¾—
- POST /api/hotel-member/hierarchy/auth/verify             â†’ JWTæ¤œè¨¼ï¼ˆè¨±å¯ï¼‰
- POST /api/hotel-member/hierarchy/permissions/check-customer-access â†’ é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆè¨±å¯ï¼‰
- POST /api/hotel-member/hierarchy/tenants/accessible      â†’ ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§
- POST /api/hotel-member/hierarchy/permissions/check-membership-restrictions â†’ ä¼šå“¡åˆ¶é™ï¼ˆãªã—ï¼‰
- POST /api/hotel-member/hierarchy/permissions/check-analytics-access â†’ åˆ†ææ¨©é™ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
- POST /api/hotel-member/hierarchy/user/permissions-detail â†’ æ¨©é™è©³ç´°
- POST /api/hotel-member/hierarchy/permissions/batch-check â†’ ãƒãƒƒãƒæ¨©é™ãƒã‚§ãƒƒã‚¯
- GET  /api/hotel-member/hierarchy/health                  â†’ éšå±¤ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

ğŸ¯ ç›®çš„: Sunoã®éšå±¤æ¨©é™çµ±åˆå®Ÿè£…ã‚’ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤
âš ï¸  æ³¨æ„: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºç”¨ãƒ»åŸºæœ¬çš„ã«å…¨ã¦è¨±å¯ï¼‰
ğŸ”„ å¾Œã§å®Œå…¨ç‰ˆã«ç½®ãæ›ãˆäºˆå®š
  

ğŸš¨ ç·Šæ€¥å¯¾å¿œï¼šhotel-commonæœ€å°ç‰ˆã‚µãƒ¼ãƒãƒ¼èµ·å‹•æˆåŠŸï¼

ğŸ“Š ã‚µãƒ¼ãƒãƒ¼æƒ…å ±:
- ãƒãƒ¼ãƒˆ: 3400
- ãƒ¢ãƒ¼ãƒ‰: ç·Šæ€¥ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- å¯¾è±¡: Sunoéšå±¤æ¨©é™çµ±åˆæ”¯æ´
- çŠ¶æ…‹: âœ… æ­£å¸¸å‹•ä½œä¸­

âœ… åˆ©ç”¨å¯èƒ½APIï¼ˆå…¨ã¦ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè£…ï¼‰:
- GET  /health                                              â†’ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/campaigns/active                               â†’ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å–å¾—
- POST /api/hotel-member/hierarchy/auth/verify             â†’ JWTæ¤œè¨¼ï¼ˆè¨±å¯ï¼‰
- POST /api/hotel-member/hierarchy/permissions/check-customer-access â†’ é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆè¨±å¯ï¼‰
- POST /api/hotel-member/hierarchy/tenants/accessible      â†’ ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§
- POST /api/hotel-member/hierarchy/permissions/check-membership-restrictions â†’ ä¼šå“¡åˆ¶é™ï¼ˆãªã—ï¼‰
- POST /api/hotel-member/hierarchy/permissions/check-analytics-access â†’ åˆ†ææ¨©é™ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰
- POST /api/hotel-member/hierarchy/user/permissions-detail â†’ æ¨©é™è©³ç´°
- POST /api/hotel-member/hierarchy/permissions/batch-check â†’ ãƒãƒƒãƒæ¨©é™ãƒã‚§ãƒƒã‚¯
- GET  /api/hotel-member/hierarchy/health                  â†’ éšå±¤ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

ğŸ¯ ç›®çš„: Sunoã®éšå±¤æ¨©é™çµ±åˆå®Ÿè£…ã‚’ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤
âš ï¸  æ³¨æ„: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºç”¨ãƒ»åŸºæœ¬çš„ã«å…¨ã¦è¨±å¯ï¼‰
ğŸ”„ å¾Œã§å®Œå…¨ç‰ˆã«ç½®ãæ›ãˆäºˆå®š
  
node:internal/modules/cjs/loader:1215
  throw err;
  ^

Error: Cannot find module '.prisma/client/default'
Require stack:
- /Users/kaneko/hotel-common/node_modules/@prisma/client/default.js
- /Users/kaneko/hotel-common/dist/server/integration-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at Object.<anonymous> (/Users/kaneko/hotel-common/node_modules/@prisma/client/default.js:2:6)
    at Module._compile (node:internal/modules/cjs/loader:1529:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1613:10)
    at Module.load (node:internal/modules/cjs/loader:1275:32)
    at Module._load (node:internal/modules/cjs/loader:1096:12)
    at Module.require (node:internal/modules/cjs/loader:1298:19) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/kaneko/hotel-common/node_modules/@prisma/client/default.js',
    '/Users/kaneko/hotel-common/dist/server/integration-server.js'
  ]
}

Node.js v20.19.2
PostgreSQLæ¥ç¶šç¢ºèªå®Œäº†
[32m[2025-08-14T23:30:07.652Z] INFO[0m [hotel-common]: ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–ä¸­...
[32m[2025-08-14T23:30:07.653Z] INFO[0m [hotel-common]: âœ… hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–å®Œäº†
[32m[2025-08-14T23:30:07.653Z] INFO[0m [hotel-common]: 
ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆç¨¼åƒä¸­

ğŸ“Š å¯¾å¿œæ©Ÿèƒ½:
- éšå±¤JWTèªè¨¼çµ±åˆ
- é¡§å®¢ãƒ‡ãƒ¼ã‚¿éšå±¤ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- ä¼šå“¡ãƒ©ãƒ³ã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆéšå±¤ç®¡ç†
- ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ææ¨©é™åˆ¶å¾¡
- FastAPIé€£æºã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ğŸ”— APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- VERIFY_TOKEN: /api/hotel-member/hierarchy/auth/verify
- CHECK_CUSTOMER_ACCESS: /api/hotel-member/hierarchy/permissions/check-customer-access
- CHECK_MEMBERSHIP_RESTRICTIONS: /api/hotel-member/hierarchy/permissions/check-membership-restrictions
- CHECK_ANALYTICS_ACCESS: /api/hotel-member/hierarchy/permissions/check-analytics-access
- BATCH_CHECK: /api/hotel-member/hierarchy/permissions/batch-check
- GET_ACCESSIBLE_TENANTS: /api/hotel-member/hierarchy/tenants/accessible
- GET_PERMISSIONS_DETAIL: /api/hotel-member/hierarchy/user/permissions-detail
- HEALTH_CHECK: /api/hotel-member/hierarchy/health

ğŸ¯ å®Ÿè£…æˆ¦ç•¥: éƒ¨åˆ†å¯¾å¿œï¼ˆé¡§å®¢ãƒ‡ãƒ¼ã‚¿é‡ç‚¹ï¼‰
âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿æœ€å°åŒ–
ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: éšå±¤åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
    
hotel-memberçµ±åˆåˆæœŸåŒ–å®Œäº†

ğŸ‰ hotel-commonçµ±åˆAPIã‚µãƒ¼ãƒãƒ¼èµ·å‹•å®Œäº†ï¼

ğŸ“Š ã‚µãƒ¼ãƒãƒ¼æƒ…å ±:
- ãƒãƒ¼ãƒˆ: 3400
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL (hotel_unified_db)
- ç›£è¦–å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ : 4å€‹

ğŸ”— åˆ©ç”¨å¯èƒ½ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- GET  /health                    - ã‚µãƒ¼ãƒãƒ¼ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/systems/status        - ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šçŠ¶æ³
- POST /api/systems/:name/test    - ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šãƒ†ã‚¹ãƒˆ
- GET  /api/database/test         - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
- GET  /api/tenants              - ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§
- POST /api/auth/validate        - èªè¨¼æ¤œè¨¼
- GET  /api/stats                - ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆ
- GET  /api/v1/campaigns/health  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ©Ÿèƒ½ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/apps/google-play     - Google Playã‚¢ãƒ—ãƒªä¸€è¦§

ğŸ¯ æ¥ç¶šå¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ :
- ğŸª hotel-saas (http://localhost:3100)
- ğŸ¯ hotel-member-frontend (http://localhost:3200)
- ğŸ¯ hotel-member-backend (http://localhost:8080)
- ğŸ’¼ hotel-pms (http://localhost:3300)
        
Performing periodic health check...
Connection test failed for hotel-pms: Unexpected token 'O', "OK

" is not valid JSON
Connection test failed for hotel-member-backend: HTTP error: 504
Connection test failed for hotel-saas: HTTP error: 404
Performing periodic health check...
Connection test failed for hotel-pms: Unexpected token 'O', "OK

" is not valid JSON
Connection test failed for hotel-member-backend: HTTP error: 504
Connection test failed for hotel-saas: HTTP error: 404
Performing periodic health check...
Connection test failed for hotel-pms: Unexpected token 'O', "OK

" is not valid JSON
Connection test failed for hotel-member-backend: HTTP error: 504
Connection test failed for hotel-saas: HTTP error: 404
PostgreSQLæ¥ç¶šç¢ºèªå®Œäº†
[32m[2025-08-15T05:22:30.865Z] INFO[0m [hotel-common]: ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–ä¸­...
[32m[2025-08-15T05:22:30.865Z] INFO[0m [hotel-common]: âœ… hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–å®Œäº†
[32m[2025-08-15T05:22:30.865Z] INFO[0m [hotel-common]: 
ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆç¨¼åƒä¸­

ğŸ“Š å¯¾å¿œæ©Ÿèƒ½:
- éšå±¤JWTèªè¨¼çµ±åˆ
- é¡§å®¢ãƒ‡ãƒ¼ã‚¿éšå±¤ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- ä¼šå“¡ãƒ©ãƒ³ã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆéšå±¤ç®¡ç†
- ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ææ¨©é™åˆ¶å¾¡
- FastAPIé€£æºã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ğŸ”— APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- VERIFY_TOKEN: /api/hotel-member/hierarchy/auth/verify
- CHECK_CUSTOMER_ACCESS: /api/hotel-member/hierarchy/permissions/check-customer-access
- CHECK_MEMBERSHIP_RESTRICTIONS: /api/hotel-member/hierarchy/permissions/check-membership-restrictions
- CHECK_ANALYTICS_ACCESS: /api/hotel-member/hierarchy/permissions/check-analytics-access
- BATCH_CHECK: /api/hotel-member/hierarchy/permissions/batch-check
- GET_ACCESSIBLE_TENANTS: /api/hotel-member/hierarchy/tenants/accessible
- GET_PERMISSIONS_DETAIL: /api/hotel-member/hierarchy/user/permissions-detail
- HEALTH_CHECK: /api/hotel-member/hierarchy/health

ğŸ¯ å®Ÿè£…æˆ¦ç•¥: éƒ¨åˆ†å¯¾å¿œï¼ˆé¡§å®¢ãƒ‡ãƒ¼ã‚¿é‡ç‚¹ï¼‰
âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿æœ€å°åŒ–
ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: éšå±¤åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
    
hotel-memberçµ±åˆåˆæœŸåŒ–å®Œäº†

ğŸ‰ hotel-commonçµ±åˆAPIã‚µãƒ¼ãƒãƒ¼èµ·å‹•å®Œäº†ï¼

ğŸ“Š ã‚µãƒ¼ãƒãƒ¼æƒ…å ±:
- ãƒãƒ¼ãƒˆ: 3400
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL (hotel_unified_db)
- ç›£è¦–å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ : 4å€‹

ğŸ”— åˆ©ç”¨å¯èƒ½ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- GET  /health                    - ã‚µãƒ¼ãƒãƒ¼ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/systems/status        - ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šçŠ¶æ³
- POST /api/systems/:name/test    - ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šãƒ†ã‚¹ãƒˆ
- GET  /api/database/test         - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
- GET  /api/tenants              - ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§
- POST /api/auth/validate        - èªè¨¼æ¤œè¨¼
- GET  /api/stats                - ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆ
- GET  /api/v1/campaigns/health  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ©Ÿèƒ½ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/apps/google-play     - Google Playã‚¢ãƒ—ãƒªä¸€è¦§

ğŸ¯ æ¥ç¶šå¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ :
- ğŸª hotel-saas (http://localhost:3100)
- ğŸ¯ hotel-member-frontend (http://localhost:3200)
- ğŸ¯ hotel-member-backend (http://localhost:8080)
- ğŸ’¼ hotel-pms (http://localhost:3300)
        
PostgreSQLæ¥ç¶šç¢ºèªå®Œäº†
[32m[2025-08-15T06:13:17.695Z] INFO[0m [hotel-common]: ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–ä¸­...
[32m[2025-08-15T06:13:17.695Z] INFO[0m [hotel-common]: âœ… hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–å®Œäº†
[32m[2025-08-15T06:13:17.695Z] INFO[0m [hotel-common]: 
ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆç¨¼åƒä¸­

ğŸ“Š å¯¾å¿œæ©Ÿèƒ½:
- éšå±¤JWTèªè¨¼çµ±åˆ
- é¡§å®¢ãƒ‡ãƒ¼ã‚¿éšå±¤ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- ä¼šå“¡ãƒ©ãƒ³ã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆéšå±¤ç®¡ç†
- ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ææ¨©é™åˆ¶å¾¡
- FastAPIé€£æºã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ğŸ”— APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- VERIFY_TOKEN: /api/hotel-member/hierarchy/auth/verify
- CHECK_CUSTOMER_ACCESS: /api/hotel-member/hierarchy/permissions/check-customer-access
- CHECK_MEMBERSHIP_RESTRICTIONS: /api/hotel-member/hierarchy/permissions/check-membership-restrictions
- CHECK_ANALYTICS_ACCESS: /api/hotel-member/hierarchy/permissions/check-analytics-access
- BATCH_CHECK: /api/hotel-member/hierarchy/permissions/batch-check
- GET_ACCESSIBLE_TENANTS: /api/hotel-member/hierarchy/tenants/accessible
- GET_PERMISSIONS_DETAIL: /api/hotel-member/hierarchy/user/permissions-detail
- HEALTH_CHECK: /api/hotel-member/hierarchy/health

ğŸ¯ å®Ÿè£…æˆ¦ç•¥: éƒ¨åˆ†å¯¾å¿œï¼ˆé¡§å®¢ãƒ‡ãƒ¼ã‚¿é‡ç‚¹ï¼‰
âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿æœ€å°åŒ–
ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: éšå±¤åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
    
hotel-memberçµ±åˆåˆæœŸåŒ–å®Œäº†

ğŸ‰ hotel-commonçµ±åˆAPIã‚µãƒ¼ãƒãƒ¼èµ·å‹•å®Œäº†ï¼

ğŸ“Š ã‚µãƒ¼ãƒãƒ¼æƒ…å ±:
- ãƒãƒ¼ãƒˆ: 3400
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL (hotel_unified_db)
- ç›£è¦–å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ : 4å€‹

ğŸ”— åˆ©ç”¨å¯èƒ½ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- GET  /health                    - ã‚µãƒ¼ãƒãƒ¼ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/systems/status        - ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šçŠ¶æ³
- POST /api/systems/:name/test    - ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶šãƒ†ã‚¹ãƒˆ
- GET  /api/database/test         - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
- GET  /api/tenants              - ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§
- POST /api/auth/validate        - èªè¨¼æ¤œè¨¼
- GET  /api/stats                - ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆ
- GET  /api/v1/campaigns/health  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ©Ÿèƒ½ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- GET  /api/apps/google-play     - Google Playã‚¢ãƒ—ãƒªä¸€è¦§

ğŸ¯ æ¥ç¶šå¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ :
- ğŸª hotel-saas (http://localhost:3100)
- ğŸ¯ hotel-member-frontend (http://localhost:3200)
- ğŸ¯ hotel-member-backend (http://localhost:8080)
- ğŸ’¼ hotel-pms (http://localhost:3300)
        
2025-08-15T06:17:17.242Z GET /health
2025-08-15T06:17:28.999Z GET /api/v1/admin/pages
Performing periodic health check...
Connection test failed for hotel-pms: Unexpected token 'O', "OK

" is not valid JSON
Connection test failed for hotel-saas: HTTP error: 404
PostgreSQLæ¥ç¶šç¢ºèªå®Œäº†
[32m[2025-08-15T06:21:32.955Z] INFO[0m [hotel-common]: ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–ä¸­...
[32m[2025-08-15T06:21:32.955Z] INFO[0m [hotel-common]: âœ… hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–å®Œäº†
[32m[2025-08-15T06:21:32.955Z] INFO[0m [hotel-common]: 
ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆç¨¼åƒä¸­

ğŸ“Š å¯¾å¿œæ©Ÿèƒ½:
- éšå±¤JWTèªè¨¼çµ±åˆ
- é¡§å®¢ãƒ‡ãƒ¼ã‚¿éšå±¤ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- ä¼šå“¡ãƒ©ãƒ³ã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆéšå±¤ç®¡ç†
- ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ææ¨©é™åˆ¶å¾¡
- FastAPIé€£æºã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ğŸ”— APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- VERIFY_TOKEN: /api/hotel-member/hierarchy/auth/verify
- CHECK_CUSTOMER_ACCESS: /api/hotel-member/hierarchy/permissions/check-customer-access
- CHECK_MEMBERSHIP_RESTRICTIONS: /api/hotel-member/hierarchy/permissions/check-membership-restrictions
- CHECK_ANALYTICS_ACCESS: /api/hotel-member/hierarchy/permissions/check-analytics-access
- BATCH_CHECK: /api/hotel-member/hierarchy/permissions/batch-check
- GET_ACCESSIBLE_TENANTS: /api/hotel-member/hierarchy/tenants/accessible
- GET_PERMISSIONS_DETAIL: /api/hotel-member/hierarchy/user/permissions-detail
- HEALTH_CHECK: /api/hotel-member/hierarchy/health

ğŸ¯ å®Ÿè£…æˆ¦ç•¥: éƒ¨åˆ†å¯¾å¿œï¼ˆé¡§å®¢ãƒ‡ãƒ¼ã‚¿é‡ç‚¹ï¼‰
âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿æœ€å°åŒ–
ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: éšå±¤åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
    
hotel-memberçµ±åˆåˆæœŸåŒ–å®Œäº†
node:events:502
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3400
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/Users/kaneko/hotel-common/node_modules/express/lib/application.js:635:24)
    at HotelIntegrationServer.start (/Users/kaneko/hotel-common/dist/server/integration-server.js:409:36)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1944:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3400
}

Node.js v20.19.2
2025-08-15T06:21:40.120Z GET /api/v1/admin/pages
2025-08-15T06:23:04.125Z GET /api/health
Performing periodic health check...
Connection test failed for hotel-pms: Unexpected token 'O', "OK

" is not valid JSON
Connection test failed for hotel-saas: HTTP error: 404
2025-08-15T06:24:24.800Z GET /api/v1/admin/pages
2025-08-15T06:26:17.179Z GET /api/v1/admin/pages
2025-08-15T06:27:26.502Z GET /api/v1/admin/pages
Performing periodic health check...
Connection test failed for hotel-pms: fetch failed
Connection test failed for hotel-saas: HTTP error: 404
hotel-commonçµ±åˆAPIã‚µãƒ¼ãƒãƒ¼åœæ­¢ä¸­...
hotel-commonçµ±åˆAPIã‚µãƒ¼ãƒãƒ¼åœæ­¢å®Œäº†
PostgreSQLæ¥ç¶šç¢ºèªå®Œäº†
[32m[2025-08-15T08:23:14.024Z] INFO[0m [hotel-common]: ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–ä¸­...
[32m[2025-08-15T08:23:14.025Z] INFO[0m [hotel-common]: âœ… hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆåˆæœŸåŒ–å®Œäº†
[32m[2025-08-15T08:23:14.025Z] INFO[0m [hotel-common]: 
ğŸ¯ hotel-memberéšå±¤æ¨©é™ç®¡ç†çµ±åˆç¨¼åƒä¸­

ğŸ“Š å¯¾å¿œæ©Ÿèƒ½:
- éšå±¤JWTèªè¨¼çµ±åˆ
- é¡§å®¢ãƒ‡ãƒ¼ã‚¿éšå±¤ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- ä¼šå“¡ãƒ©ãƒ³ã‚¯ãƒ»ãƒã‚¤ãƒ³ãƒˆéšå±¤ç®¡ç†
- ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ææ¨©é™åˆ¶å¾¡
- FastAPIé€£æºã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

ğŸ”— APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:
- VERIFY_TOKEN: /api/hotel-member/hierarchy/auth/verify
- CHECK_CUSTOMER_ACCESS: /api/hotel-member/hierarchy/permissions/check-customer-access
- CHECK_MEMBERSHIP_RESTRICTIONS: /api/hotel-member/hierarchy/permissions/check-membership-restrictions
- CHECK_ANALYTICS_ACCESS: /api/hotel-member/hierarchy/permissions/check-analytics-access
- BATCH_CHECK: /api/hotel-member/hierarchy/permissions/batch-check
- GET_ACCESSIBLE_TENANTS: /api/hotel-member/hierarchy/tenants/accessible
- GET_PERMISSIONS_DETAIL: /api/hotel-member/hierarchy/user/permissions-detail
- HEALTH_CHECK: /api/hotel-member/hierarchy/health

ğŸ¯ å®Ÿè£…æˆ¦ç•¥: éƒ¨åˆ†å¯¾å¿œï¼ˆé¡§å®¢ãƒ‡ãƒ¼ã‚¿é‡ç‚¹ï¼‰
âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿æœ€å°åŒ–
ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: éšå±¤åˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
    
hotel-memberçµ±åˆåˆæœŸåŒ–å®Œäº†
node:events:502
      throw er; // Unhandled 'error' event
      ^

Error: listen EADDRINUSE: address already in use :::3400
    at Server.setupListenHandle [as _listen2] (node:net:1908:16)
    at listenInCluster (node:net:1965:12)
    at Server.listen (node:net:2067:7)
    at Function.listen (/Users/kaneko/hotel-common/node_modules/express/lib/application.js:635:24)
    at HotelIntegrationServer.start (/Users/kaneko/hotel-common/dist/server/integration-server.js:414:36)
Emitted 'error' event on Server instance at:
    at emitErrorNT (node:net:1944:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  code: 'EADDRINUSE',
  errno: -48,
  syscall: 'listen',
  address: '::',
  port: 3400
}

Node.js v20.19.2
node:internal/modules/cjs/loader:1215
  throw err;
  ^

Error: Cannot find module '../generated/prisma'
Require stack:
- /Users/kaneko/hotel-common/dist/server/api-health.js
- /Users/kaneko/hotel-common/dist/server/integration-server.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1212:15)
    at Module._load (node:internal/modules/cjs/loader:1043:27)
    at Module.require (node:internal/modules/cjs/loader:1298:19)
    at require (node:internal/modules/helpers:182:18)
    at Object.<anonymous> (/Users/kaneko/hotel-common/dist/server/api-health.js:8:18)
    at Module._compile (node:internal/modules/cjs/loader:1529:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1613:10)
    at Module.load (node:internal/modules/cjs/loader:1275:32)
    at Module._load (node:internal/modules/cjs/loader:1096:12)
    at Module.require (node:internal/modules/cjs/loader:1298:19) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/kaneko/hotel-common/dist/server/api-health.js',
    '/Users/kaneko/hotel-common/dist/server/integration-server.js'
  ]
}

Node.js v20.19.2
