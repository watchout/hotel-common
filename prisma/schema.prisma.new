generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// æ—¢å­˜ã®ãƒ¢ãƒ‡ãƒ«å®šç¾©ã¯ã“ã“ã«ç¶šã...

// ==============================================
// ğŸ“„ ãƒšãƒ¼ã‚¸ç®¡ç†ï¼ˆhotel-saasï¼‰
// ==============================================

model Page {
  Id          String    @id @default(cuid())
  TenantId    String    // ãƒ†ãƒŠãƒ³ãƒˆID
  Slug        String    // ãƒšãƒ¼ã‚¸ã®è­˜åˆ¥å­ï¼ˆä¾‹ï¼š'top', 'info', 'menu'ï¼‰
  Title       String    // ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«
  Html        String?   @db.Text // HTMLå½¢å¼ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
  Css         String?   @db.Text // CSSã‚¹ã‚¿ã‚¤ãƒ«
  Content     String?   @db.Text // JSONå½¢å¼ã§BlockNoteã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¿å­˜
  Template    String?   // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè­˜åˆ¥å­
  IsPublished Boolean   @default(false) // å…¬é–‹çŠ¶æ…‹
  PublishedAt DateTime? // å…¬é–‹æ—¥æ™‚
  Version     Int       @default(1) // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
  CreatedAt   DateTime  @default(now())
  UpdatedAt   DateTime  @updatedAt

  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
  Tenant  Tenant       @relation(fields: [TenantId], references: [id])
  History PageHistory[]

  @@unique([TenantId, Slug]) // ãƒ†ãƒŠãƒ³ãƒˆã”ã¨ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªslug
  @@index([TenantId])
  @@index([Slug])
  @@index([IsPublished])
  @@map("pages")
}

model PageHistory {
  Id        String   @id @default(cuid())
  PageId    String   // è¦ªãƒšãƒ¼ã‚¸ID
  Html      String?  @db.Text // HTMLå½¢å¼ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
  Css       String?  @db.Text // CSSã‚¹ã‚¿ã‚¤ãƒ«
  Content   String?  @db.Text // JSONå½¢å¼ã§BlockNoteã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¿å­˜
  Template  String?  // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè­˜åˆ¥å­
  Version   Int      // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·
  CreatedAt DateTime @default(now())
  CreatedBy String?  // ä½œæˆè€…

  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
  Page Page @relation(fields: [PageId], references: [Id], onDelete: Cascade)

  @@index([PageId])
  @@index([Version])
  @@map("page_histories")
}
