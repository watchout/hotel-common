# ğŸ§  RAG Knowledge Base åŸºç›¤æ§‹ç¯‰

**æ§‹ç¯‰é–‹å§‹**: 2025å¹´1æœˆ23æ—¥  
**ç›®çš„**: ãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³å•é¡Œæ ¹çµ¶ãƒ»æ­£ç¢ºãªæƒ…å ±å‚ç…§ã‚·ã‚¹ãƒ†ãƒ   
**Phase**: ç·Šæ€¥å®Ÿè£…Phase 1

---

## ğŸ“Š **Prismaã‚¹ã‚­ãƒ¼ãƒæ­£ç¢ºæƒ…å ±ç™»éŒ²**

### **ğŸ¯ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒç¢ºå®šæƒ…å ±**
```yaml
æ­£å¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å: hotel_unified_db
å»ƒæ­¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å: hotel_common_dev (å‰Šé™¤æ¸ˆã¿)
ãƒ¦ãƒ¼ã‚¶ãƒ¼å: kaneko
çµ±ä¸€ãƒãƒ¼ãƒˆæ§‹æˆ:
  - hotel-saas: 3100
  - hotel-member: 3200+8080  
  - hotel-pms-browser: 3300
  - hotel-pms-electron: 3301
  - hotel-common: 3400
```

### **âœ… ç¢ºå®šå‹å®šç¾©ãƒ»å‘½åè¦å‰‡**
```yaml
Prisma Modelæ­£å¼å:
  âœ… customers (NOT customer)
  âœ… Reservation (PascalCase)
  âœ… Room (PascalCase)
  âœ… Staff (NOT User - ç§»è¡Œå®Œäº†)
  âœ… Tenant (PascalCase)
  âœ… SystemEvent (NOT system_event)

ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‘½åè¦å‰‡:
  âœ… camelCase: tenantId, checkinDate, confirmationCode
  âŒ snake_case: tenant_id, checkin_date, confirmation_code

å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å­˜åœ¨ç¢ºèª:
  âœ… tenantId (å…¨ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«)
  âœ… id, createdAt, updatedAt (æ¨™æº–ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰)
  âœ… deletedAt (è«–ç†å‰Šé™¤å¯¾å¿œ)
```

### **âš ï¸ éå­˜åœ¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆç”Ÿæˆç¦æ­¢ï¼‰**
```yaml
Reservationé–¢é€£:
  âŒ customer (å­˜åœ¨ã—ãªã„)
  âŒ checkin_date (æ­£: checkinDate)
  âŒ confirmation_code (æ­£: confirmationCode)

SystemEventé–¢é€£:
  âŒ tenant_id (æ­£: tenantId)
  âŒ user_id (æ­£: staffId - Userâ†’Staffç§»è¡Œæ¸ˆã¿)
  âŒ event_type (æ­£: eventType)

Redisé–¢é€£:
  âŒ first-entry (æ­£: firstEntry)
  âŒ last-entry (æ­£: lastEntry)
  âŒ count ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ (ç‰¹å®šAPIã§æœªå¯¾å¿œ)
```

---

## ğŸ”§ **TypeScriptã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**

### **ğŸ¯ ç¢ºå®Ÿãªè§£æ±ºãƒ‘ã‚¿ãƒ¼ãƒ³**
```yaml
å‹ã‚­ãƒ£ã‚¹ãƒˆçµ±ä¸€ãƒ‘ã‚¿ãƒ¼ãƒ³:
  âœ… catch (error: unknown) {
       const errorObj = error instanceof Error ? error : new Error(String(error));
       logger.error('ã‚¨ãƒ©ãƒ¼è©³ç´°', { error: errorObj });
     }

LogEntryå‹æ‹¡å¼µå¿…é ˆ:
  âœ… version?: string
  âœ… results?: any  
  âœ… eventType?: string
  âœ… organizationId?: string

Prismaå‹ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ¨™æº–:
  âœ… import { Tenant, Staff, customers, Reservation, Room } from '@prisma/client'
  âŒ import { tenant, staff, customer } from '@prisma/client'
```

### **ğŸš¨ çµ¶å¯¾ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**
```yaml
å‹å®‰å…¨æ€§å›é¿:
  âŒ as any ã®å¤šç”¨
  âŒ @ts-ignore ã®ä½¿ç”¨
  âŒ unknownå‹ã®ãã®ã¾ã¾ä½¿ç”¨

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è»½è¦–:
  âŒ å…¥åŠ›æ¤œè¨¼ã®çœç•¥
  âŒ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çœç•¥
  âŒ èªè¨¼ãƒ»èªå¯ãƒã‚§ãƒƒã‚¯ã®ç°¡ç•¥åŒ–

éæ¨™æº–å®Ÿè£…:
  âŒ ç›´æ¥SQLå®Ÿè¡Œï¼ˆORMä½¿ç”¨å¿…é ˆï¼‰
  âŒ å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿å­˜
  âŒ tenant_idç„¡ã—ã§ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
```

---

## ğŸ›¡ï¸ **é‡è¦åˆ¶ç´„ãƒ»ãƒ«ãƒ¼ãƒ«ï¼ˆå¿˜å´é˜²æ­¢ï¼‰**

### **ğŸ”¥ çµ¶å¯¾éµå®ˆäº‹é …**
```yaml
ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ:
  âœ… å…¨ã‚¯ã‚¨ãƒªã«tenantIdå¿…é ˆ
  âœ… ãƒ‡ãƒ¼ã‚¿åˆ†é›¢ã®å®Œå…¨ç¢ºä¿
  âœ… è¶Šå¢ƒã‚¢ã‚¯ã‚»ã‚¹ç¦æ­¢

çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ«ãƒ¼ãƒ«:
  âœ… hotel-saasã¯CRUDå‚ç…§ã®ã¿ï¼ˆäºˆç´„æ›´æ–°ç¦æ­¢ï¼‰
  âœ… hotel-pmsãŒäºˆç´„ç®¡ç†ã®æ­£æœ¬
  âœ… hotel-memberãŒé¡§å®¢ãƒã‚¹ã‚¿ã®æ­£æœ¬
  âœ… Event-drivené€£æºå¿…é ˆ

èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:
  âœ… JWTçµ±ä¸€èªè¨¼åŸºç›¤
  âœ… éšå±¤çš„æ¨©é™ç®¡ç†
  âœ… ã™ã¹ã¦ã®API endpointã§èªè¨¼å¿…é ˆ
```

### **ğŸ“‹ hotelæ¥­ç•Œç‰¹æœ‰è¦ä»¶**
```yaml
é‹ç”¨è¦ä»¶:
  âœ… 24æ™‚é–“é‹ç”¨å¯¾å¿œ
  âœ… ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œå¯¾å¿œï¼ˆPMSãƒ»SaaSï¼‰
  âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åœ¨åº«ãƒ»äºˆç´„åŒæœŸ

ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§:
  âœ… ãƒ€ãƒ–ãƒ«ãƒ–ãƒƒã‚­ãƒ³ã‚°çµ¶å¯¾ç¦æ­¢
  âœ… æ±ºæ¸ˆãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨æ€§ç¢ºä¿
  âœ… é¡§å®¢å€‹äººæƒ…å ±ã®é©åˆ‡ãªä¿è­·

ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:
  âœ… ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³/ã‚¢ã‚¦ãƒˆå‡¦ç† < 3ç§’
  âœ… åœ¨åº«æ¤œç´¢ < 1ç§’
  âœ… ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ < 30ç§’
```

---

## ğŸ¯ **è‡ªå‹•æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…**

### **Phase 1: åŸºæœ¬ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½**
```yaml
ã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯:
  1. ç”Ÿæˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ vs å®Ÿéš›ã®Prismaã‚¹ã‚­ãƒ¼ãƒç…§åˆ
  2. å­˜åœ¨ã—ãªã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å‚ç…§ã®æ¤œå‡º
  3. å‹å®šç¾©ä¸æ•´åˆã®è‡ªå‹•è­¦å‘Š

å‘½åè¦å‰‡ãƒã‚§ãƒƒã‚¯:
  1. snake_case vs camelCaseæ··åœ¨æ¤œå‡º
  2. æ¨™æº–å‘½åãƒ‘ã‚¿ãƒ¼ãƒ³ã¸ã®è‡ªå‹•ææ¡ˆ
  3. éæ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å³åº§è­¦å‘Š

å¿…é ˆè¦ä»¶ãƒã‚§ãƒƒã‚¯:
  1. tenantIdæ¼ã‚Œæ¤œå‡º
  2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å­˜åœ¨ç¢ºèª  
  3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶å……è¶³ç¢ºèª
```

### **Phase 2: é«˜åº¦æ¤œè¨¼æ©Ÿèƒ½**
```yaml
ä¿¡é ¼ã‚¹ã‚³ã‚¢å®Ÿè£…:
  1. ç”Ÿæˆå†…å®¹ã®ç¢ºå®Ÿæ€§è©•ä¾¡ï¼ˆ0-100%ï¼‰
  2. ä½ç¢ºå®Ÿæ€§æ™‚ã®æ‰‹å‹•ç¢ºèªä¿ƒé€²
  3. é«˜ãƒªã‚¹ã‚¯å¤‰æ›´ã®äº‹å‰è­¦å‘Š

ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’æ©Ÿèƒ½:
  1. æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã®è“„ç©ãƒ»å†åˆ©ç”¨
  2. ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­¦ç¿’ãƒ»äºˆé˜²
  3. hotel-commonç‰¹åŒ–æœ€é©åŒ–
```

---

## âš¡ **å³åº§å®Ÿè¡Œãƒªã‚¹ãƒˆ**

### **ğŸ”¥ ä»Šã™ãå®Ÿè¡Œï¼ˆ15åˆ†ä»¥å†…ï¼‰**
```yaml
âœ… Knowledge BaseåŸºç›¤æ–‡æ›¸ä½œæˆ
â³ LogEntryå‹å®šç¾©æ‹¡å¼µå®Ÿè£…
â³ å‹ã‚­ãƒ£ã‚¹ãƒˆçµ±ä¸€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä½œæˆ
â³ åŸºæœ¬æ¤œè¨¼æ©Ÿèƒ½ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—
```

### **â­ æ¬¡æ®µéšå®Ÿè¡Œï¼ˆ60åˆ†ä»¥å†…ï¼‰**
```yaml
â³ Prismaã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Ÿè£…
â³ å‘½åè¦å‰‡è‡ªå‹•ä¿®æ­£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â³ é‡è¦åˆ¶ç´„ã®å®šæœŸå†ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ©Ÿèƒ½
â³ ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†é¡ãƒ»å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
```

---

## ğŸ“Š **åŸºç›¤æ§‹ç¯‰é€²æ—**

### **âœ… å®Œäº†é …ç›®**
- [x] æ­£ç¢ºãªä»•æ§˜ãƒ»åˆ¶ç´„ã®æ§‹é€ åŒ–è¨˜éŒ²
- [x] ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†é¡ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–
- [x] è‡ªå‹•æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ
- [x] å®Ÿè£…å„ªå…ˆé †ä½ã®æ±ºå®š

### **ğŸ”„ å®Ÿè£…ä¸­é …ç›®**
- [ ] LogEntryå‹å®šç¾©æ‹¡å¼µ
- [ ] å‹ã‚­ãƒ£ã‚¹ãƒˆçµ±ä¸€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
- [ ] åŸºæœ¬æ¤œè¨¼æ©Ÿèƒ½
- [ ] Prismaã‚¹ã‚­ãƒ¼ãƒæ•´åˆæ€§ãƒã‚§ãƒƒã‚¯

---

**ğŸ¯ æ–‡çŒ®1ã®çŸ¥è¦‹ã‚’åŸºã«ã€ãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å¿˜å´å•é¡Œã®æ ¹æœ¬è§£æ±ºåŸºç›¤ãŒæ§‹ç¯‰ã•ã‚Œã¾ã™ï¼**

**æœ€çµ‚æ›´æ–°**: 2025å¹´1æœˆ23æ—¥  
**æ¬¡å›æ›´æ–°**: Phase 1å®Ÿè£…å®Œäº†å¾Œ 